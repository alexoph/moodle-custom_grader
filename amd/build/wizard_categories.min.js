function _objectSpread(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{},d=Object.keys(c);if("function"==typeof Object.getOwnPropertySymbols){d=d.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))}d.forEach(function(b){_defineProperty(a,b,c[b])})}return a}function _defineProperty(a,b,c){if(b in a){Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0})}else{a[b]=c}return a}define ("local_customgrader/wizard_categories",["jquery"],function(a,b){var k={CATEGORY:"cat",ROW:"row"},l={cancelButtonClass:"swal-button-cancel",confirmButtonColor:"#d51b23",confirmButtonClass:"swal-button-confirm"};function c(){for(var a=window.location.search.split("="),b=-1,c=0;c<a.length;c+=2){if("?id"===a[c]){b=a[c+1]}}return b}var m=function(a,c){var d=_objectSpread({},a,l);return b(d,c)};function d(b,c,d){a.ajax({type:"POST",data:{course:b,element:c,type_e:d,type:"loadParentCat"},url:"managers/ajax_processing.php",success:function success(b){console.log(b);a("#padre").html(b.html)},dataType:"json",cache:"false",error:function error(a){console.log("ajax error");console.log(a)}})}var n=function(b,c,d){return a.ajax({type:"POST",data:{type_ajax:"deleteElement",id:b,courseid:c,type:d},dataType:"json",cache:"false",url:"managers/ajax_processing.php"})};function e(b,d){var e=a("#tipoItem").val(),k=c();if("CATEGOR\xCDA"==e){if(j(b)){var l=a.trim(a("#inputNombre").val()),n=a("#inputValor").val(),o=f(a("#tipoCalificacion").prop("selectedIndex"));a.ajax({type:"POST",data:{course:k,parent:d,fullname:l,agregation:o,tipo:e,peso:n},url:"managers/ajax_processing.php",success:function success(a){if(1==a){m({title:"Categoria a\xF1adida con exito",html:!0,type:"success",confirmButtonColor:"#d51b23"});i(k)}else if(0==a){m({title:"Error al a\xF1adir la categoria (server error)",html:!0,type:"error",confirmButtonColor:"#d51b23"})}},cache:"false",error:function error(a){m({title:"Error al intentar a\xF1adir la categoria",html:!0,type:"error",confirmButtonColor:"#d51b23"});console.log(a)}})}}else if("\xCDTEM"==e){if(g(b)){var l=a.trim(a("#inputNombre").val()),n=a("#inputValor").val();a.ajax({type:"POST",data:{course:k,parent:d,fullname:l,tipo:e,peso:n},url:"managers/ajax_processing.php",success:function success(a){if(1==a){m({title:"item a\xF1adido con exito",html:!0,type:"success",confirmButtonColor:"#d51b23"});i(k)}else if(0==a){m({title:"Error al a\xF1adir el item (server error)",html:!0,type:"error",confirmButtonColor:"#d51b23"})}},cache:"false",error:function error(a){m({title:"Error al intentar a\xF1adir el item",html:!0,type:"error",confirmButtonColor:"#d51b23"});console.log(a)}})}}else if("PARCIAL"==e){if(h(b)){var l=a.trim(a("#inputNombre").val()),n=a("#inputValor").val();a.ajax({type:"POST",data:{course:k,parent:d,fullname:l,agregation:6,tipo:e,peso:n},url:"managers/ajax_processing.php",success:function success(a){if(1==a){m({title:"Categoria a\xF1adida con exito",html:!0,type:"success",confirmButtonColor:"#d51b23"});i(k)}else if(0==a){m({title:"Error al a\xF1adir la categoria (server error)",html:!0,type:"error",confirmButtonColor:"#d51b23"})}},cache:"false",error:function error(a){m({title:"Error al intentar a\xF1adir la categoria",html:!0,type:"error",confirmButtonColor:"#d51b23"});console.log(a)}})}}else{m({title:"Seleccione el tipo de elemento que desea crear",html:!0,type:"warning",confirmButtonColor:"#d51b23"})}}function f(a){switch(a){case 1:return 0;break;case 2:return 10;break;}}function g(b){var c=a.trim(a("#inputNombre").val());if(""===c){m({title:"Ingrese el nombre del \xEDtem que desea crear",html:!0,type:"warning",confirmButtonColor:"#d51b23"});return!1}if(10===b){var d=a("#inputValor").val();if(""===d){m({title:"Ingrese un peso v\xE1lido entre 0 y "+maxweight,html:!0,type:"warning",confirmButtonColor:"#d51b23"});return!1}}return!0}function h(b){var c=a.trim(a("#inputNombre").val());if(""===c){m({title:"Ingrese el nombre del parcial que desea crear",html:!0,type:"warning",confirmButtonColor:"#d51b23"});return!1}if(10===b){var d=a("#inputValor").val();if(""==d){m({title:"Ingrese un peso v\xE1lido entre 0 y "+maxweight,html:!0,type:"warning",confirmButtonColor:"#d51b23"});return!1}}return!0}function i(b){a.ajax({type:"POST",data:{course:b,type:"loadCat"},url:"managers/ajax_processing.php",success:function success(b){a("#mymodalbody").html(b)},dataType:"text",cache:"false",error:function error(a){console.log(a)}})}function j(b){if(0==a("#tipoCalificacion").prop("selectedIndex")){m({title:"Seleccione el tipo de calificaci\xF3n de la categor\xEDa que desea crear",html:!0,type:"warning",confirmButtonColor:"#d51b23"});return!1}var c=a.trim(a("#inputNombre").val());if(""==c){m({title:"Ingrese el nombre de la categor\xEDa que desea crear",html:!0,type:"warning",confirmButtonColor:"#d51b23"});return!1}if(10==b){var d=a("#inputValor").val();if(""==d){m({title:"Ingrese un peso v\xE1lido entre 0 y "+maxweight,html:!0,type:"warning",confirmButtonColor:"#d51b23"});return!1}}return!0}var o=function(a,b,c,d,e){var f="No seleccionado";if(b===k.CATEGORY){f="la categoria: "+c}else{f="el item: "+c}var g="Esta seguro que desea eliminar "+f+"?";return m({title:g,text:"Tenga en cuenta que NO SE PODRAN RECUPERAR ninguna de la notas que haya registrado en este elemento una vez borrado!",type:"warning",showCancelButton:!0,confirmButtonClass:"btn-danger",confirmButtonText:"Aceptar, Borrar "+f,cancelButtonText:"Cancelar",closeOnCancel:!0},function(c){if(c){console.log("pos si0");return n(a,d,b).then(function(a){m({title:"Listo",text:a.msg,type:"success",showCancelButton:!1,showConfirmButton:!1,timer:2400});i(d);if(e){e()}}).catch(function(a){console.log(a)})}else{m({title:"Cancelado",type:"error",showCancelButton:!1,showConfirmButton:!1,timer:1200});return!1}})},p=function(){var b=a("<div class = 'divForm' style= 'display:none'>");b.load("templates/categories_form.html");b.toggle("slow","swing");return b};return{deleteElement:n,getCourseId:c,get_add_element_form:p,show_delete_element_dialog:o,ELEMENT_TYPES:k,init:function init(){var b,f;a(document).on("click","#wizard_button",function(){a("#modalCategories").modal({backdrop:!1});a(".fondo").show()});a(document).on("click","#tutorial-button",function(){a("#video-frame").attr("src","https://www.youtube.com/embed/8Bm_obAFBYo");a("#tutorialModal").modal({backdrop:!1});a(".fondo").show()});a(document).on("click","#close-tutorial",function(){a(".fondo").hide()});a("#tutorialModal").on("hidden.bs.modal",function(){a("#video-frame").attr("src","")});a(document).on("click","#cancel",function(){a(".fondo").hide()});a(document).on("click",".mymodal-close",function(){location.reload()});a(document).on("click",".edit",function(){var e=a(this).attr("title");a("#titulo").text(e);var f=!1;a("#nombre_editar").show();a("#label_nombre").show();a("#alta").show();a("#div_padres").show();if(a(this).hasClass("curso")){f=!0;a("#alta").hide();a("#nombre_editar").hide();a("#label_nombre").hide();a("#div_padres").hide()}var g=c(),h=a(this).attr("id");a("#save_edit").attr("name",h);if("Editar Categor\xEDa"===e){a("#type_cal").show();var i=a(this).parent().parent().attr("id");a("#otro").hide();if(10!=i&&0!=i&&6!=i){i=99;a("#otro").show()}a("#calific").prop("value",i);var j=k.CATEGORY,l=a(this).parent().parent().text();if(-1==l.search("-")){var m=l.split("(");l=m[0];o=m[1];if(!f){a("#peso").show()}o=o.replace("(","");o=o.replace(")","");o=o.replace(" ","");o=o.replace("%","");b=o;a("#peso_editar").val(o);var n=a(this).attr("data-maxweight");a(".maxweight-edit").attr("id",n)}else{l=l.split("-")[0];a("#peso").hide()}}else{a("#type_cal").hide();var o=a(this).parent().parent().prev().text();if("-"==o){a("#peso").hide();a("#peso_editar").val(o)}else{a("#peso").show();o=o.replace("(","");o=o.replace(")","");o=o.replace(" ","");o=o.replace("%","");b=o;a("#peso_editar").val(o);var n=a(this).parent().attr("id");a(".maxweight-edit").attr("id",n)}var j="it",l=a(this).parent().parent().prev().prev().attr("title");if("Enlazar a la actividad Tarea"==l){a("#nombre_editar").hide();a("#label_nombre").hide()}}a("#nombre_editar").val(l);d(g,h,j);a("#edit").modal({backdrop:!1});a(".fondo").show()});a(document).on("click","#save_edit",function(){var d=a(this).attr("name"),e=a("#nombre_editar").val(),f=a("#peso_editar").val(),g=parseFloat(a(".maxweight-edit").attr("id"))+parseFloat(b),h=a("#calific").val(),j=a("#padre").val();if("-"==f){f=0}if("99"==h){m({title:"Tipo de Calificacion no valida.",text:"No es posible editar una categoria con un tipo de calificacion diferente a Promedio Simple, Promedio Ponderado, o Calificacion mas alta.\n Por favor seleccione uno de estos tipos de calificacion",html:!0,type:"warning",confirmButtonColor:"#d51b23"});return}if(f>g){m({title:"Peso no valido.",text:"El peso ingresado supera el peso m\xE1ximo posible de la categoria padre que es: "+g+"% \n Para crear un nuevo elemento primero configure los pesos de los demas.",html:!0,type:"warning",confirmButtonColor:"#d51b23"});return}if(""==e){m({title:"Ingrese el nuevo nombre del elemento",html:!0,type:"warning",confirmButtonColor:"#d51b23"});return}var l=a("#titulo").text();if("\xCDtem"==l.split(" ")[1]){var n="it";h=!1}else{n=k.CATEGORY}var o=c();a.ajax({type:"POST",data:{course:o,element:d,type_e:n,newNombre:e,newPeso:f,newCalific:h,type:"editElement",parent:j},url:"managers/ajax_processing.php",success:function success(b){if(b.error){m("Error",b.error,"error")}else{m({title:"Listo",text:b.msg,type:"success",showCancelButton:!1,showConfirmButton:!1,timer:1300});a("#edit").modal("hide");a(".fondo").hide();i(o);console.log(b)}},dataType:"json",cache:"false",error:function error(a){m("Server Error",a.error,"error");console.log("AJAXerror");console.log(a)}})});a(document).on("click",".delete",function(){var b=a(this).parent().parent().parent().attr("id").split("_"),d=c(),e=a(this).attr("data-name"),f=b[1],g=b[0];o(f,g,e,d)});a(document).on("click",".new",function(){f=a(this).parent().parent().children().next(".maxweight").attr("id");if(0>=f){m({title:"No se pueden crear mas categor\xEDas o \xEDtems en la categoria seleccionada.",text:"\n\r El peso de los elementos dentro de \xE9sta suma 100%.\n\r Para crear un nuevo elemento primero configure los pesos de los demas.",html:!0,type:"warning",confirmButtonColor:"#d51b23"});return}a(".new").prop("disabled",!0);a(".delete").prop("disabled",!0);a(".edit").prop("disabled",!0);var b=a(this).parent().parent();b.append("<hr style = \"margin: 6px 0;border-top: 1px solid #ddd\">");var d=p();b.append(d);window.setTimeout(function(){var d=b.attr("id");if(10==d){a("#divPeso").show();a("#inputValor").on("blur",function(){var b=a(this).val(),c=parseInt(a(this).parent().parent().parent().parent().children().next(".maxweight").attr("id"));if(0>b||b>c){m({title:"El valor debe estar entre 0 y el peso m\xE1ximo: "+c,text:"\n\rUsted ingres\xF3: "+b,html:!0,type:"warning",confirmButtonColor:"#d51b23"});a(this).val("")}});a("#inputValor").on("keypress",function(a){var b=document.all?a.keyCode:a.which;if(8==b||46==b){return!0}var c=/[0-9]/,d=String.fromCharCode(b);return c.test(d)})}a("#tipoItem").on("change",function(){var b=a(this).prop("selectedIndex");if(1==b){a("#divTipeC").show()}else{a("#divTipeC").hide()}});a("#save").on("click",function(){var b=a(this).parent().parent().parent().parent().attr("id"),c=a(this).parent().parent().parent().parent().parent().attr("id");c=c.split("_")[1];e(b,c)});a("#cancel").on("click",function(){var a=c();i(a)})},400)})}}});
//# sourceMappingURL=wizard_categories.min.js.map
